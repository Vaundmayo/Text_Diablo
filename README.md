
#  텍스트 디아블로 게임 개발 보고서

---

## 1. 프로젝트 개요

### 1.1 개발 목적  
이 프로젝트는 C언어를 기반으로 RPG 게임 **‘텍스트 디아블로’**를 완성하는 것을 목표로 진행됨.
기존에 제공된 Act 1과 Act 2 일부 코드를 분석한 뒤, **Act 2(Quest 4~6)**과 **Act 3, Act 4의 모든 퀘스트**를 구현하였음.
이를 통해 구조체, 파일 입출력, 문자열 처리, 함수 분할, 터미널 제어 등 C언어 기능들을 실제 프로그램에 적용해봄.  
또한 여러 운영체제에서도 실행 가능하도록 하였음.


### 1.2 개발 환경  
| 구분 | 내용 |
|------|------|
| 사용 언어 | C 언어 |
| 개발 환경 | Windows 10 / Ubuntu 22.04 |
| 컴파일러 | MinGW, GCC |
| 주요 라이브러리 | stdio.h, stdlib.h, string.h, time.h, termios.h, unistd.h 등 |
| 실행 형태 | 텍스트 기반 콘솔 프로그램 |

---

## 2. 컴파일 및 실행 방법

###  Windows

```bash
gcc Diablo-m-test.c -o diablo.exe
diablo.exe
```

* 실행 파일과 동일한 폴더에 모든 퀘스트 데이터(`Quest1_1.dat` 등)를 둔다.

###  Linux / macOS

```bash
make
./diablo
```

* `termios.h`를 활용해 `getch()` 대체 함수를 구현했다.
* ANSI 이스케이프 코드(`printf("\033[2J\033[1;1H");`)를 사용하여 화면을 초기화한다.
* 퀘스트 `.dat` 파일이 없으면 시나리오가 출력되지 않는다.

###  실행 시 유의사항

* `.dat` 파일은 반드시 UTF-8 인코딩으로 작성해야 한글이 깨지지 않는다.
* `savedata.sav`은 세이브 시 자동으로 생성된다.
* 파일 경로가 다르면 텍스트 파일을 불러오지 못하므로 동일 폴더 내에 두어야 한다.

---

## 3. 프로그램 구조

### 3.1 전체 흐름

1. 캐릭터 생성 또는 불러오기
2. 액트 선택 후 퀘스트 시작
3. 전투(`battle`) 수행
4. 경험치 및 보상 반영 → 다음 퀘스트 해금
5. 모든 액트 완료 후 엔딩 출력

### 3.2 핵심 함수 구성

| 함수명                   | 기능                            |
| --------------------- | ----------------------------- |
| `main()`              | 게임 루프 및 초기 메뉴                 |
| `set()`, `battle()`   | 전투와 턴 처리                      |
| `Q1_1() ~ Q4_3()`     | 퀘스트 전투 및 시나리오 진행              |
| `save()`, `load()`    | 사용자 정보(`struct user`) 저장/불러오기 |
| `clrscr()`, `delay()` | 콘솔 연출 및 화면 제어                 |

### 3.3 데이터 파일 구성

* `weapon.qwe` : 상점 무기 목록
* `defence.qwe` : 상점 방어구 목록
* ~`magic.dat` : 직업별 마법 선택
* `Quest1_1.dat` ~ `Quest4_3.dat` : 퀘스트별 시나리오 및 대사
* `savedata.sav` : 플레이어 진행 상태
* 모든 `.dat` 파일은 `fopen("Quest1_1.dat", "rt")` 형태로 읽는 텍스트 데이터 파일임

---

## 4. 액트별 구현 내용

| Act   | 주요 보스 | 특징                   |
| ----- | ----- | -------------------- |
| Act 1 | 안때리얼  | 기본 전투 시스템            |
| Act 2 | 듀리엘   | 다단계 전투               |
| Act 3 | 메피스토  | 다중 몬스터 조합, 전투 다양성 강화 |
| Act 4 | 디아블로  | 최종 보스전 및 엔딩 연출       |

###  Act 2

* 오염된 보노보노 및 조개류 몬스터 토벌
* 상남초 담임좀비 6명 처치
* 단군상 아래 듀리엘 보스전


###  Act 3

* 퀘스트별 테마를 부여 (DJ 증오, 마녀 징징이, 뽀로로 등)
* 반복 전투와 보스전으로 전투 다양화

###  Act 4

* 하수의 군단 → 중수의 군단 → 디아블로의 3단계 전투
* 보스전 전용 대사와 엔딩 구현

---

## 5. 문제 해결

### 5.1 비어있는 퀘스트 시나리오 구성

* **문제:** 일부 퀘스트의 .dat 파일이 비어있거나 대사가 누락되어, 진행 시 화면에 아무 내용이 출력되지 않음.
* **해결:** 기존 시나리오 흐름을 참고하여 빈 퀘스트의 대사와 전투 이벤트를 직접 구성함.
	또한 파일 입출력 오류를 방지하기 위해, .dat 파일이 존재하지 않을 경우 경고 문구를 출력하도록 수정함.

### 5.2 보기 편한 화면과 직관적인 안내멘트로 변경

* **문제:** 메뉴나 상점 등에서 사용자의 선택을 직관적으로 이끌어내지 못함.
* **해결:** gotoxy()와 ANSI 이스케이프 코드를 활용해 메뉴 배치를 정렬하고, 상황별 메시지를 하단에 표시하도록 개선함.
	이를 통해 사용자 경험(UX)이 개선되어 게임 진행이 훨씬 직관적으로 바뀜.

### 5.3 누락 및 오류 기능 구현

* **문제:** Condition() 함수 실행 시 캐릭터 정보 출력 후 바로 메뉴로 돌아가는 현상 발생.
	Run away 기능은 조건 없이 실행되어 도망 시 다음 적으로 넘어가 버리는 오류 존재.
* **해결:** Condition() 내부에 getch() 대기 루틴을 추가하여 정상적으로 화면이 유지되도록 수정.
	Run away는 전투 진행 조건을 세분화하고, 각 몬스터별 도망 처리 로직을 추가하여 도망 성공/실패 여부가 명확히 반영되도록 개선함.

### 5.4 밸런스 불균형

* **문제:** 일부 몬스터의 HP와 공격력 차이가 심함
* **해결:** 액트 별 `my_random()` 범위 수정으로 밸런스 조정

### 5.5 마법 시전 로직 개선

* **문제:** 마법 선택 시 잘못된 입력값(0 이하나 MP 부족 상태 등)에서도 반복이 종료되거나 잘못된 동작이 발생함.
	또한 goto 문 사용으로 코드 가독성이 떨어짐
* **해결:** Cancel(0) 시 정상 복귀하도록 수정하고, 입력 검증을 반복문(while) 기반으로 재구성함.
	또한 마법 사용 시 MP 차감과 데미지 계산이 올바르게 반영되도록 로직을 정리함.

---

## 6. 실행 결과

* Act 1~4 전체 정상 동작 확인
* 각 퀘스트 시나리오 및 대사 출력 정상
* 보스 처치 후 경험치 및 골드 반영 완료
* 최종 보스 디아블로 클리어 후 엔딩 출력

---

## 7. 결론

이번 프로젝트를 통해**C언어의 구조적 설계, 상태 관리, 파일 입출력, 호환성 처리**를 종합적으로 학습할 수 있었음.
기존 코드를 분석하고 확장하는 과정에서
함수 관리와 코드 분석의 중요성을 배움.

조별 협업을 통해 파트별 구현과 코드 테스트를 병행하면서
충돌 없는 병합과 일정 조율의 필요성도 체감함.
최종적으로 Act 4까지 완성하여 게임의 유저가 디아블로를 처치하고
결말을 맞이할 수 있도록 전체 흐름을 자연스럽게 마무리함.

---

## 8. 참고자료

* 과제 설명서: *C언어 기반 '텍스트 디아블로' 게임 완성하기*
* 조원 작성 시나리오 파일 `디아블로_시나리오 베이스.txt`
* git 사용법(인터넷 참고)
* ANSI Escape Code 참고자료
